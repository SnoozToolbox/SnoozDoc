.. _PSA_Cohort_Review:

=================================================
Power Spectral Analysis (PSA) Cohort Review
=================================================

Description
-----------------

A tool to explore, clean (such as removing bad channels or renaming channels), and transpose the PSA report in order to have 1 subject per row.

The PSA report is generated by the :ref:`Power_Spectral_Analysis` tool in Snooz.

.. warning::

   The option to generate the PSA report has to be checked by the user on step "7 - Output Files" in the :ref:`Power_Spectral_Analysis` tool.

The generated report includes the same variable names as the input report. 
However, in the transposed report, the channel label and the frequency band are concatenated to the variable name as a suffix.  

.. note::
   
   * I.e. ``act_total`` from the PSA report becomes ``act_total_abs_EEG F3-RC_1_4`` for the channel ``EEG F3-RC`` and the absolute power in the frequency band 1-4 Hz. 
   * I.e. ``act_total`` from the PSA report becomes ``act_total_rel_EEG F3-RC_1_4`` for the channel ``EEG F3-RC`` and the relative power in the frequency band 1-4 Hz. 

Steps
-----------------

**1 - Input Files**

PSA report : 

   Add your PSA files generated by the tool :ref:`Power_Spectral_Analysis`.
  
Channel label :

   The channel label is editable by double-clicking on the name.  You can change the channel name at the subject level or at the cohort level. A channel label changed at the cohort level will be effective to all the subjects loaded.  Uncheck a channel to remove it.

Region Of Interest : 

	You can add ROI at the cohort level to average many channels together.  Once you press the "Add ROI" button : check the channels to include in the ROI (this list will be adapted to the cohort loaded).  Check the blank option if you want the ROI empty (blank) when data is missing for the mean otherwise missing data is just ignored.

**2 - Frequency Band**

	You can add a new band with the button "Add" or load an existing file with the button "Load".  You can edit a frequency band loaded.

	The spectral power can be absolute or relative.

	- For absolute power : init only the numerator of the frequency band.

	- For relative power : init the numerator and the denominator of the frequency band.
	
   You can save the frequency band you edited.

   .. warning::

      For absolute power the "num-start(Hz)" and "num-end(Hz)" must be init and "den-start(Hz)" and "den-end(Hz)" should be let nan (not a number) 


**2 - Output Files**

Check the reports you want to generate:

   * the report cleaned (with edited channels)
   * the report transposed

If you want to export the transposed report, define how to average the events characteristics across the recording.

	* Select "Total" to output the average through the whole recording.
	* Select "Distribution per hour" to output the average per real clock hour, from hour 1 to 12.  The start point is the sleep onset.
	* Select "Distribution per sleep cycle" to output the average per sleep cycle, from sleep cycle 1 to 6.  The start point is the sleep onset.
	* Select "Distribution per annotation" to output the average per selected annotation. No cycle or hour information is available for this option.

Define the filename to save the exported files (the sufix _clean or _transposed will be added to the filename)
The output file is a .tsv (tab separated values) file. 

.. Warning::
   
   The current output is added (appended) to the existing output file.